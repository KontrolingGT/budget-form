<script type="text/javascript">
        var gk_isXlsx = false;
        var gk_xlsxFileLookup = {};
        var gk_fileData = {};
        function filledCell(cell) {
          return cell !== '' && cell != null;
        }
        function loadFileData(filename) {
        if (gk_isXlsx && gk_xlsxFileLookup[filename]) {
            try {
                var workbook = XLSX.read(gk_fileData[filename], { type: 'base64' });
                var firstSheetName = workbook.SheetNames[0];
                var worksheet = workbook.Sheets[firstSheetName];

                // Convert sheet to JSON to filter blank rows
                var jsonData = XLSX.utils.sheet_to_json(worksheet, { header: 1, blankrows: false, defval: '' });
                // Filter out blank rows (rows where all cells are empty, null, or undefined)
                var filteredData = jsonData.filter(row => row.some(filledCell));

                // Heuristic to find the header row by ignoring rows with fewer filled cells than the next row
                var headerRowIndex = filteredData.findIndex((row, index) =>
                  row.filter(filledCell).length >= filteredData[index + 1]?.filter(filledCell).length
                );
                // Fallback
                if (headerRowIndex === -1 || headerRowIndex > 25) {
                  headerRowIndex = 0;
                }

                // Convert filtered JSON back to CSV
                var csv = XLSX.utils.aoa_to_sheet(filteredData.slice(headerRowIndex)); // Create a new sheet from filtered array of arrays
                csv = XLSX.utils.sheet_to_csv(csv, { header: 1 });
                return csv;
            } catch (e) {
                console.error(e);
                return "";
            }
        }
        return gk_fileData[filename] || "";
        }
        </script><!DOCTYPE html>

<html lang="pl">
<head>
<meta charset="utf-8"/>
<meta content="width=device-width, initial-scale=1.0" name="viewport"/>
<title>Formularz Budżetowy GT</title>
<style>
        body { font-family: Arial, sans-serif; max-width: 800px; margin: 20px auto; padding: 10px; background-color: #f4f4f4; }
        .budget-container { background-color: #ffffff; padding: 20px; border-radius: 8px; box-shadow: 0 0 10px rgba(0,0,0,0.1); border: 2px solid #000000; }
        h2, h3, h4, h5 { color: #f05a28; }
        input, select, textarea, button { margin: 10px 0; padding: 8px; width: 100%; box-sizing: border-box; border: 4px solid #000000; border-radius: 4px; }
        button { background-color: #f05a28; color: white; border: none; cursor: pointer; font-weight: bold; }
        button:hover { background-color: #d94a20; }
        #send-data, #download-excel, #download-json { background-color: #000000; color: white; }
        #send-data:hover, #download-excel:hover, #download-json:hover { background-color: #333333; }
        #clear-data { background-color: #f05a28; color: white; }
        #clear-data:hover { background-color: #d94a20; }
        table { width: 100%; border-collapse: collapse; margin-top: 20px; border: 1px solid #000000; }
        th, td { border: 1px solid #000000; padding: 8px; text-align: left; color: black; }
        th { background-color: #f05a28; color: white; }
        .section { margin-bottom: 20px; }
        .month-inputs { display: flex; flex-wrap: wrap; gap: 10px; }
        .month-inputs input { width: 100px; }
        label { color: black; display: block; margin-bottom: 5px; }
        .employee-note { color: #000000; font-size: 14px; font-style: italic; margin-top: -10px; margin-bottom: 10px; }
        .client-subsection { margin-left: 20px; }
        .client-info { margin-left: 20px; margin-bottom: 10px; }
    </style>
</head>
<body>
<div class="budget-container">
<h2>Formularz Budżetowy GT</h2>
<!-- Sekcja: Dane kandydata -->
<div class="section">
<h3>Dane kandydata</h3>
<input id="candidate-name" placeholder="Imię i nazwisko" type="text"/>
<input id="candidate-email" placeholder="E-mail" type="email"/>
<input id="candidate-city" placeholder="Miasto" type="text"/>
<input id="candidate-phone" placeholder="Telefon" type="text"/>
<label for="candidate-start-date">Data startu oddziału:</label>
<input id="candidate-start-date" type="date"/>
<select id="candidate-employment">
<option value="">Wybierz formę zatrudnienia</option>
<option value="B2B">B2B</option>
<option value="Umowa o pracę">Umowa o pracę</option>
</select>
</div>
<!-- Sekcja: Klienci -->
<div class="section">
<h3>Dane klientów</h3>
<div id="clients-section"></div>
<button id="add-client-btn">Dodaj kolejnego klienta</button>
</div>
<!-- Sekcja: Zatrudnienie -->
<div class="section">
<h3>Zatrudnienie</h3>
<p class="employee-note">Proszę wprowadzić wartość brutto wynagrodzenia na umowie o pracę lub wartość netto FV na B2B.</p>
<div id="employees-section"></div>
<button id="add-employee-btn">Dodaj kolejnego pracownika</button>
</div>
<!-- Sekcja: Pojazdy służbowe -->
<div class="section">
<h3>Pojazdy służbowe</h3>
<div id="vehicles-section"></div>
<button id="add-vehicle-btn">Dodaj kolejny pojazd</button>
</div>
<!-- Sekcja: Uzupełniające informacje -->
<div class="section">
<h3>Uzupełniające informacje</h3>
<input id="branch-work-type" placeholder="Forma pracy oddziału" type="text"/>
<input id="office-rent-cost" placeholder="Szacowane miesięczne koszty najmu biura (PLN)" type="number"/>
<label><input id="exchange-timo" type="checkbox"/> Dostęp do giełdy Timo</label>
<label><input id="exchange-trans" type="checkbox"/> Dostęp do giełdy Trans</label>
<input id="exchange-other" placeholder="Inne giełdy" type="text"/>
<label><input id="has-carriers" onchange="toggleCarriersComment()" type="checkbox"/> Posiada bazę przewoźników</label>
<textarea id="carriers-comment" placeholder="Komentarz do bazy przewoźników" style="display: none;"></textarea>
<textarea id="candidate-comments" placeholder="Opis / Komentarz / Uwagi kandydata"></textarea>
</div>
<!-- Podgląd danych -->
<div class="section">
<h3>Podgląd danych</h3>
<table>
<thead>
<tr>
<th>Sekcja</th>
<th>Dane</th>
</tr>
</thead>
<tbody id="data-table-body"></tbody>
</table>
</div>
<!-- Przyciski akcji -->
<button id="send-data">Wyślij dane e-mailem</button>
<button id="download-excel">Pobierz dane jako Excel</button>

<button id="clear-data">Wyczyść wszystkie dane</button>
</div>
<!-- Biblioteki zewnętrzne -->
<script src="https://cdn.jsdelivr.net/npm/@emailjs/browser@3/dist/email.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>

</body>
</html>